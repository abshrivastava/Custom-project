(function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:d})},b.n=function(a){var c=a&&a.__esModule?function(){return a['default']}:function(){return a};return b.d(c,'a',c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p='',b(b.s=0)})([function(a,b,c){c(1),c(2),c(3),c(4)},function(){(function(){angular.module('app.components',[]).component('cpLoader',{template:'<div ng-show="ctrl.isLoading" class="loading-page"><i class="fa fa-spinner fa-pulse loading-icon"></i></div>',controller:['$rootScope','$window',function(a,b){var c=this;c.$onInit=function(){a.$on('triggerLoader',function(a,d){var e=angular.element(document.querySelector('#memberUiView'))[0].scrollHeight+angular.element(document.querySelector('header')).innerHeight();angular.element(document.querySelector('.loading-page')).css('height',Math.max(e,b.innerHeight)),c.isLoading=d.isLoading})}}],controllerAs:'ctrl'})})()},function(){(function(){angular.module('app.helpers',['ngMap']).factory('cpUtils',['$window','$document','$state','$q','$timeout','NgMap',function(a,b,c,d,e,f){function g(){h(angular.element(document.querySelector('#left-sidebar')),'close-sidebar'),h(angular.element(document.querySelector('#header')),'left-pannel'),h(angular.element(document.querySelector('#member')),'left-pannel')}function h(a,b){a.hasClass(b)?a.removeClass(b):a.addClass(b)}function i(a){return!('[object Date]'!==Object.prototype.toString.call(a))&&!isNaN(a.getTime())}return{hasData:function(a){return a&&a.data&&0<a.data.length},hasDetails:function(a){return a&&0<Object.keys(a).length},hasValue:function(a){return a&&0<a.length},loadScript:function(){angular.element(document.querySelector('.login-overlay')).hide();var b=a.innerHeight,c=angular.element(document.querySelector('header')).innerHeight();angular.element(document.querySelector('#content_wrapper')).css('padding-top',c),angular.element(document.querySelector('#left-sidebar')).css('height',b),angular.element(document.querySelector('#content_wrapper')).css('height',b)},toggleFlyout:g,goTo:function(a,b,d){a?c.go(a,b,{reload:d}):c.reload()},goBack:function(){a.history.back()},closeFlyout:function(){angular.element(document.querySelector('#left-sidebar')).hasClass('close-sidebar')||g()},validateEmail:function(a){if(!a)return!1;var b=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return b.test(a)},validateNumber:function(a){if(!a)return!1;var b=/^[0-9]*$/;return b.test(a)},parseDate:function(a){return a=a?new Date(a.replace(/-/g,'/')):'',i(a)?a:''},isMobile:function(){let a=new MobileDetect(window.navigator.userAgent);return!!a.mobile()},getErrorDetails:function(a){return{error_code:a.status,error_message:a.statusText}},timeOut:function(a){var b=d.defer();return e(function(){b.resolve(!0)},a),b.promise},resizeMap:function(a,b){b&&f.getMap(a).then(function(a){let c=b.split(','),d={lat:parseFloat(c[0]),lng:parseFloat(c[1])};google.maps.event.trigger(a,'resize'),a.markers[0].setPosition(d),a.setCenter(d)})}}}])})()},function(){(function(){function a(a,b,c,d,e,f,g){function h(d){var g=b.defer();return!f.hasDetails(e.get('MemberData'))||d?a.get('/rewards/mem/get').then(function(a){a.data&&a.data.memberid?(a.data.dob=moment(a.data.dob).toDate(),e.set('MemberData',a.data),c.$emit('refreshMemberData'),g.resolve(a.data)):(window.location='/login',g.resolve(!1))},function(){g.reject(!1)}):g.resolve(e.get('MemberData')),g.promise}function i(a){return h(!0).then(function(){return a},function(){return a})}function j(c){return a.post('/rewards/mem/getPoyntsLog',c).then(function(a){return a.data},function(a){return b.reject(f.getErrorDetails(a))})}function k(c){return a.post('/rewards/mem/getMemberGiftCardData',c).then(function(a){return a.data},function(a){return b.reject(f.getErrorDetails(a))})}function l(a){var b=[],c=[];return g('filter')(a,function(d){if(-1===b.indexOf(d.transaction_date)){b.push(d.transaction_date);let e=g('filter')(a,function(a){return d.transaction_date==a.transaction_date});return c.push({transactionDate:d.transaction_date,transactionData:e}),!0}return!1}),c}return{getMember:h,getMemberEnterprises:function(){return a.get('/rewards/mem/enterprises').then(function(a){return a.data},function(){return b.reject()})},login:function(c){return a.post('/login',c).then(function(a){return a.data},function(){return b.reject()})},saveProfile:function(c){return a.post('/rewards/mem/profile/save',c).then(function(a){return a.data},function(){return b.reject()})},getMemberStepsToday:function(){return a.get('/rewards/mem/steps-today').then(function(a){return a.data},function(){return b.reject()})},getHumanApiProfile:function(){return a.get('/rewards/mem/humanapi').then(function(a){return a.data},function(){return b.reject()})},getOnboardUrl:function(){return a.get('/rewards/mem/onboardUrl').then(function(a){return a.data},function(){return b.reject()})},sendMemberEmail:function(c){return a.post('/rewards/mem/help',c).then(function(a){return a.data},function(){return b.reject()})},sendReferralEmail:function(c){return a.post('/rewards/mem/referbusiness',c).then(function(a){return a.data},function(){return b.reject()})},getMemberAddToHomescreenTag:function(){return a.get('/rewards/mem/getMemberAddToHomescreenTag').then(function(a){return a.data},function(){return b.reject()})},postCheckin:function(c,d){return a.post('/enterprise-service/scan_earn',d).then(function(a){return i(a.data)},function(){return b.reject()})},createAddToHomeTag:function(c){return a.post('/tag-service/createMemberTag',c).then(function(a){return a.data},function(){return b.reject()})},getMemberPoyntsLog:j,getMemberGiftCardData:k,saveInterests:function(c){return a.post('/tag-service/member/interests/save',c).then(function(a){return a.data},function(){return b.reject()})},getInterests:function(){return a.get('/tag-service/member/interests/get').then(function(a){return a.data},function(){return b.reject()})},getMemberTags:function(c){const d='/tag-service/getMemberTags?memberid='+c.memberid;var e=b.defer();return a.get(d,c).then(function(a){a&&a.data?e.resolve(a.data):e.reject(!1)},function(a){e.reject(a)}),e.promise},getPurchaseDetails:function(a){var c=b.defer();return k({entId:a.entid,memberId:a.memberid}).then(function(a){c.resolve(a)},function(a){c.reject(a)}),c.promise},getMemberPoyntsLogDetails:function(a){let c=b.defer();return j({entId:a.entid,memberId:a.memberid,poyntBalance:a.reward.points}).then(function(a){c.resolve(l(a))},function(a){c.reject(a)}),c.promise}}}angular.module('app.member',['app.utils','app.helpers']).factory('memberService',a),a.$inject=['$http','$q','$rootScope','notificationService','cacheService','cpUtils','$filter']})()},function(){(function(){function a(a,b){return{getFeatureToggles:function(c){return a.get('/rewards/feature-toggles',c).then(function(a){return a.data},function(){return b.reject()})}}}angular.module('app.feature-toggle',[]).factory('featureToggleService',a),a.$inject=['$http','$q']})()}]);